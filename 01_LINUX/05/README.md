# VI
VI(Visual Editor)
---
> 리눅스 문서(ex 파일) 편집기

|-|
|-|
|![image](https://github.com/silverywaves/DEPLOY/assets/155939946/dd41ea0d-8df8-4e16-88ca-19c27dbc9be3)|

<br>

### vi 모드
```
  이동 모드	(초기모드)	- 파일 내 이동 
  입력 모드	(편집모드)	- 파일 내 수정 
  EX 모드	(명령어 실행) 	- 파일 내외에 특정 명령어 실행
```

<br>

이동모드
---
### 1. 이동
```
  [환경]
  mkdir /vitest
  cp /etc/passwd /etc/login.defs /vitest
  vi /vitest/passwd
  :set number		-행번호 출력
```

> 커서 기준
```
  h : 왼쪽으로 한칸이동
  J : 아래로 한칸이동 
  K : 위로 한칸이동
  L : 오른쪽으로 한칸이동
```

> 단어 기준
```
  W(west) : 다음 단어의 처음으로 이동
  e (east) : 다음단어의 끝으로 이동
  b(back) : 이전단어의 처음으로 이동
```

> 행기준
```
  0 : 커서행의 처음으로 이동 
  $ : 커서행의 끝으로 이동
```

> 문서기준
```
  gg: 문서의 처음
  G : 문서의 끝
  [[  : 문서처음
  ]]  : 문서끝
```

> 페이지 이동
```
  1) 페이지 간 이동
    컨트롤 + f : 다음페이지
    컨트롤 + b : 이전 페이지
  
  2) 페이지 내 이동
    Shift + high
    Shift + middle
    Shift + low
```

<br>

### 2. 복사&삭제
```
  x	: 한글자씩 삭제
  dd	: 1행 삭제
  숫자+dd	: 숫자만큼 행삭제
  yy	: 1행 복사
  숫자+yy	: 숫자만큼 행복사
  p	: 붙여넣기
```

> 삭제 활용
```
  1) 단어삭제
    dw,de 	: 커서 위치 단어 삭제
    db 	: 전 단어 삭제
  
  2) 행삭제
    d0	:커서부터 행의 처음까지 삭제	
    d$	:커서부터 행의 끝까지 삭제
  
  3) 문서복사
    dgg	:커서부터 문서 처음까지 삭제
    dG	:커서부터 문서 끝까지 삭제
```

> 복사 활용
```
  1) 단어 복사
    yw,ye,yb
  
  2) 행복사
    y0	:커서부터 행의 처음까지 복사	
    ys	:커서부터 행의 끝까지 복사
  
  3) 문서복사
    ygg	:커서부터 문서 처음까지 복사
    yG	:커서부터 문서 끝까지 복사
  
  붙여넣기  : p
  
  되돌리기 : u
  역되돌리기 : ctrl+r
```

<br>

### 3. 변경
```
  r	: 한문자 변경
```

<br>

### 4. 블럭지정
```
  v		: 커서 블럭 지정 
  shift+ v	: 행단위 블럭 지정
  y		: 블럭 복사
  c		: 블럭 잘라내기	,붙여넣기 : p
  d 		: 블럭 삭제
  ~ 		: 대소문자 전환
  U		: 대문자로 변환
  u		: 소문자로 변환
  >		: tab만큼 들여 쓰기
  <		: tab만큼 내어 쓰기
```

<br>

#### 미니예제
```
  v로 블럭지정 y -> p
  shift + v  블럭지정 - >c -> p
  v 블럭지정 -> d
  v 블럭지정 ->  ~
```

<br>

### 5. 기타
> 여러 문서 열기
```
  cd /vitest
  vi login.defs  passwd
  
  :N,:n으로 전환
  :set number 행번호 붙이기
  :set nonumber  행번호 없애기
```

<br>

#### 미니문제
```
  1. 7번 행 삭제
  2. 현재 위치에서 문서 처음까지 삭제
  2. 11번 행 2행복사 붙여넣기
  3. 15번 행부터 문서끝까지 행복사 후 문서 맨아래에서 붙여넣기
  4. 1,2,3 작업 다시 되돌리기
```

<details>
  <summary>답</summary>

```

```

</details>

<br>

#### 연습문제
```
  [환경]
  mkdir /vitest
  cp /etc/passwd /vitest
  vi /vitest/passwd
  :se nu
  
  [문제]
  1.현재 커서 위치에서 h,j,k,l 키를 이용해서 행 마지막으로 이동하세요
  2.현재 커서 위치에서 w,e,b 키를 이용해서 다음 행의 끝으로 이동하세요
  3.다음 행의 처음으로 이동해서 한번에 행끝으로 이동하세요
  4.행끝에서 다시 행의 처음으로 한번에 이동 하세요
  5.문서 끝으로 이동하세요
  6.문서 처음으로 이동하세요
  7.다음 페이지로 이동하세요
  8.이전 페이지로 돌아오세요
  9. 3번째 행으로 이동한뒤 'x' 한문자를 삭제 하세요
  10. 5번째 행으로 이동한뒤 한행을 삭제하세요
  11. 문서마지막으로 이동한뒤 3행위로 이동 후 3행 삭제하세요
  12. 문서처음으로 이동후 1행 복사 후 붙여넣기 하세요
  13. 문서 처음부터 끝까지 복사후 제일 마지막행으로 이동 후 붙여넣기 하세요
  14. 현재작업내용을 모두 되돌리세요
  15. 1행의 'root' 만 블럭 지정 후 복사해서 행의 제일 마지막에 붙여넣기 하세요
  16. 3행의 'daemon' 만 블럭 지정 후 잘라내서 행의 제일 마지막에 붙여넣기 하세요
```

<details>
  <summary>답</summary>

```

```

</details>

<br>

편집모드
---
```
  a	:  오른쪽으로 한 칸 이동 후 편집모드 진입  
  
  i	:  그 자리에서 편집모드 진입
  
  o	: 행 추가 후 편집모드 진입 
  
  s	: 현재 문자를 지우고 편집모드로 진입
```

<br>

실행모드
---
> 검색<br>치환<br>외부명령어 수행
```
  [환경]
  mkdir /vitest
  cp /etc/passwd /vitest
  cd /vitest
  vi passwd
```

<br>

### 1. 검색 : '/','?'
```
  /  :커서기준으로 아래로 검색
  ? :커서 기준으로 위로 검색 
  
  n : 검색 문자 정방향 이동 
  N : 검색 문자 역방향 이동
```

> 확인
```
  /var - > n, N 이동 확인 
  ?var - > n, N 이동 확인 
```

<br>

### 2. 치환
```
  [범위]s/원본/수정/옵션
```

> 확인
```
  :s/th/1234		커서행 최초 1개 치환
  :s/th/1234/g		커서행 모두 치환  g: ‘모두’ 라는 뜻
  :10,12s/i/1234		지정범위 1개 치환
  :10,12s/i/1234/g	지정범위 모두 치환(g)
  :%s/th/1234/g		문서전체는 %s 사용
  :%s/\/etc/\!!!/g	특수문자는 역슬러시(\)를 이용한다!!!
```

<br>

#### 미니문제
```
  첫행의 모든 0을 0000으로 치환 하세요
  vi 내에서 모든 x를 y 로 치환 하세요
  vi 내에서 모든 /를 ***으로 치환 하세요 
  강사확인 후 원래대로 되돌리세요 
```

<br>

### 3. 외부 명령어 실행 
```
  :  	명령 실행모드
  . 	현재 위치로
  !  	외부 명령어 수행
  
  :! 	외부에서 명령어 수행 	
  :.!	외부의 명령어의 수행 결과를 vi모드로 가져 옴 	
  	문서 커서행에 명령 수행 내용을 삽입
  	(원본행 삭제되므로 행추가(o->esc) 후 사용)
```

> 확인
```
  :! ls -al /etc				
  :! mkdir /vitest/test && touch /vitest/test/testfile
  :! ls -al /vitest /vitest/test
  
  마지막 행에서 진행
  :.! cal 03 2017
  :.! head -5 /etc/ssh/ssh_conf
  
  ※ :!cd는 사용 불가
```

<br>

### 4. 창 나누기
```
  [n]split [파일명]  -> 가로로 창나누기
  
  CTRL + ww : 창간 이동
  CTRL + wn : 새창 띄우기
```

<br>

### 5. 저장&종료
```
  :enew   [파일명]  	새문서 열기(기존파일 닫고 새문서 생성)
  :w		저장
  :q 		나가기(저장x)
  :w [파일명]	해당 파일명으로 저장(=다른이름으로 저장)
  
  :q!		강제 나가기
  :wq		저장 후 나가기
  :wq [파일명]	다른 이름으로 저장 후 나가기
```

<br>

#### 미니문제
```
  1. mkdir /vitest2 만들고 /etc/login.defs파일을 /vitest2에 복사 하세요
  
  2. vi 명령어를 이용해서 /vitest2/login.defs 파일의 모든 "PASS"를 "PASSWORD"로 치환하세요  
  	(지금부터는 vi 내부에서 수행하세요)
  3. vi 명령어를 이용해서 모든'#'을 '##' 치환하세요
   
  4. vi 모드내에서 /vitest3 디렉토리를 생성하세요
  
  5.행의 마지막에 /etc/passwd의 내용중 위로부터 10줄만 가져오세요
  
  6. /vitest3 디렉토리 안에 test라는 파일명으로 저장 하세요
```

<details>
  <summary>답</summary>

```

```

</details>

<br>

